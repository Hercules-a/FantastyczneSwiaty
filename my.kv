#:import Factory kivy.factory.Factory

#:set color_armia [0.5, 0.5, 0.5, 1]
#:set color_artefakt [1, 0.39, 0.31, 1]
#:set color_bestia [0.1, 0.7, 0.1, 1]
#:set color_plomien [1, 0.1, 0.1, 1]
#:set color_powodz [0.1, 0.1, 1, 1]
#:set color_kraina [0.55, 0.27, 0.07, 1]
#:set color_przywodca [0.5, 0, 0.5, 1]
#:set color_bron [0.8, 0.8, 0.8, 1]
#:set color_pogoda [0.53, 0.8, 0.98, 1]
#:set color_czarodziej [1, 0.41, 0.7, 1]
#:set color_specjalne [1, 1, 1, 1]

<Button>:
    valign: 'center'
    halign: 'center'
    size_hint_y: None
    height: '25dp'

<ChosenCardButton@Button>:
    height: '25dp'
    size_hint_y: None
    text_size: self.size
    halign: 'center'

<MyLabel@Label>:
    valign: 'center'
    halign: 'center'
    size_hint_y: None
    text_size: self.size
    height: '25dp'

<SelectCardWindow>:
    __safe_id: [dropdown0.__self__, dropdown1.__self__, dropdown2.__self__, dropdown3.__self__, dropdown4.__self__, dropdown5.__self__, dropdown6.__self__, dropdown7.__self__, dropdown8.__self__, dropdown9.__self__, dropdown10.__self__]

    GridLayout:
        cols: 1
        anchor_y: 'top'
        size: root.width - 10, root.height - 10
        pos: 5, 5

        GridLayout:
            rows: 1
            size_hint_y: None
            height: '26dp'


            MyLabel:
                text: "Wybrano {}".format('0/7' if root.count_cards == '' else root.count_cards)
            MyLabel:
                text: "Punkty: {}".format('0' if root.sum_to_display == '' else root.sum_to_display)

        # Display chosen cards
        GridLayout:
            size_hint_y: None
            height: '115dp'
            cols: 2
            rows: 4

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 0 else root.list_of_cards[0].name
                on_release: root.del_card(0)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 1 else root.list_of_cards[1].name
                on_release: root.del_card(1)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 2 else root.list_of_cards[2].name
                on_release: root.del_card(2)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 3 else root.list_of_cards[3].name
                on_release: root.del_card(3)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 4 else root.list_of_cards[4].name
                on_release: root.del_card(4)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 5 else root.list_of_cards[5].name
                on_release: root.del_card(5)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 6 else root.list_of_cards[6].name
                on_release: root.del_card(6)

            ChosenCardButton:
                text: '' if len(root.list_of_cards) <= 7 else "{} {}".format(root.list_of_cards[7].power, root.list_of_cards[7].name)
                on_release: root.del_card(7)

        #List of all cards
        GridLayout:
            size_hint_y: None
            cols: 1
            height: '442dp'
            GridLayout:
                id: grid0
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Armia"
                    on_release: dropdown0.open(self); self.parent.height = '152dp'
                    background_color: color_armia

                Widget:
                    on_parent: dropdown0.dismiss()

                DropDown:
                    id: dropdown0
                    on_dismiss: grid0.height = '26dp'


                    Button:
                        text: "{} {}".format(root.KrasnoludzkaPiechota.power, root.KrasnoludzkaPiechota.name)
                        on_release: root.add_card(root.KrasnoludzkaPiechota)
                        background_color: color_armia

                    Button:
                        id: elfi_lucznicy
                        text: "{} {}".format(root.ElfiLucznicy.power, root.ElfiLucznicy.name)
                        on_release: root.add_card(root.ElfiLucznicy)
                        background_color: color_armia

                    Button:
                        text: "{} {}".format(root.Rycerze.power, root.Rycerze.name)
                        on_release: root.add_card(root.Rycerze)
                        background_color: color_armia

                    Button:
                        text: "{} {}".format(root.LekkaKonnica.power, root.LekkaKonnica.name)
                        on_release: root.add_card(root.LekkaKonnica)
                        background_color: color_armia

                    Button:
                        text: "{} {}".format(root.Zwiadowcy.power, root.Zwiadowcy.name)
                        on_release: root.add_card(root.Zwiadowcy)
                        background_color: color_armia

            GridLayout:
                id: grid1
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Bestia"
                    on_release: dropdown1.open(self); self.parent.height = '152dp'
                    background_color: color_bestia

                Widget:
                    on_parent: dropdown1.dismiss()

                DropDown:
                    id: dropdown1
                    on_dismiss: grid1.height = '26dp'

                    Button:
                        text: "{} {}".format(root.Bazyliszek.power, root.Bazyliszek.name)
                        on_release: root.add_card(root.Bazyliszek)
                        background_color: color_bestia

                    Button:
                        text: "{} {}".format(root.Smok.power, root.Smok.name)
                        on_release: root.add_card(root.Smok)
                        background_color: color_bestia

                    Button:
                        text: "{} {}".format(root.Hydra.power, root.Hydra.name)
                        on_release: root.add_card(root.Hydra)
                        background_color: color_bestia

                    Button:
                        text: "{} {}".format(root.Jednorozec.power, root.Jednorozec.name)
                        on_release: root.add_card(root.Jednorozec)
                        background_color: color_bestia

                    Button:
                        text: "{} {}".format(root.Rumak.power, root.Rumak.name)
                        on_release: root.add_card(root.Rumak)
                        background_color: color_bestia

            GridLayout:
                id: grid2
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Płomień"
                    on_release: dropdown2.open(self); self.parent.height = '152dp'
                    background_color: color_plomien

                Widget:
                    on_parent: dropdown2.dismiss()

                DropDown:
                    id: dropdown2
                    on_dismiss: grid2.height = '26dp'


                    Button:
                        text: "{} {}".format(root.Swieca.power, root.Swieca.name)
                        on_release: root.add_card(root.Swieca)
                        background_color: color_plomien

                    Button:
                        text: "{} {}".format(root.ZywiolakOgnia.power, root.ZywiolakOgnia.name)
                        on_release: root.add_card(root.ZywiolakOgnia)
                        background_color: color_plomien

                    Button:
                        text: "{} {}".format(root.Kuznia.power, root.Kuznia.name)
                        on_release: root.add_card(root.Kuznia)
                        background_color: color_plomien

                    Button:
                        text: "{} {}".format(root.Blyskawica.power, root.Blyskawica.name)
                        on_release: root.add_card(root.Blyskawica)
                        background_color: color_plomien

                    Button:
                        text: "{} {}".format(root.Pozar.power, root.Pozar.name)
                        on_release: root.add_card(root.Pozar)
                        background_color: color_plomien

            GridLayout:
                id: grid3
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Powódź"
                    on_release: dropdown3.open(self); self.parent.height = '152dp'
                    background_color: color_powodz

                Widget:
                    on_parent: dropdown3.dismiss()

                DropDown:
                    id: dropdown3
                    on_dismiss: grid3.height = '26dp'


                    Button:
                        text: "{} {}".format(root.FontannaZycia.power, root.FontannaZycia.name)
                        on_release: root.add_card(root.FontannaZycia)
                        background_color: color_powodz

                    Button:
                        text: "{} {}".format(root.Potop.power, root.Potop.name)
                        on_release: root.add_card(root.Potop)
                        background_color: color_powodz

                    Button:
                        text: "{} {}".format(root.Wyspa.power, root.Wyspa.name)
                        on_release: root.add_card(root.Wyspa)
                        background_color: color_powodz

                    Button:
                        text: "{} {}".format(root.Bagno.power, root.Bagno.name)
                        on_release: root.add_card(root.Bagno)
                        background_color: color_powodz

                    Button:
                        text: "{} {}".format(root.ZywiolakWody.power, root.ZywiolakWody.name)
                        on_release: root.add_card(root.ZywiolakWody)
                        background_color: color_powodz

            GridLayout:
                id: grid4
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Kraina"
                    on_release: dropdown4.open(self); self.parent.height = '152dp'
                    background_color: color_kraina

                Widget:
                    on_parent: dropdown4.dismiss()

                DropDown:
                    id: dropdown4
                    on_dismiss: grid4.height = '26dp'

                    Button:
                        text: "{} {}".format(root.Dzwonnica.power, root.Dzwonnica.name)
                        on_release: root.add_card(root.Dzwonnica)
                        background_color: color_kraina

                    Button:
                        text: "{} {}".format(root.Jaskinia.power, root.Jaskinia.name)
                        on_release: root.add_card(root.Jaskinia)
                        background_color: color_kraina

                    Button:
                        text: "{} {}".format(root.ZywiolakZiemi.power, root.ZywiolakZiemi.name)
                        on_release: root.add_card(root.ZywiolakZiemi)
                        background_color: color_kraina

                    Button:
                        text: "{} {}".format(root.Las.power, root.Las.name)
                        on_release: root.add_card(root.Las)
                        background_color: color_kraina

                    Button:
                        text: "{} {}".format(root.Gory.power, root.Gory.name)
                        on_release: root.add_card(root.Gory)
                        background_color: color_kraina

            GridLayout:
                id: grid5
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Przywódca"
                    on_release: dropdown5.open(self); self.parent.height = '152dp'
                    background_color: color_przywodca

                Widget:
                    on_parent: dropdown5.dismiss()

                DropDown:
                    id: dropdown5
                    on_dismiss: grid5.height = '26dp'

                    Button:
                        text: "{} {}".format(root.Cesarzowa.power, root.Cesarzowa.name)
                        on_release: root.add_card(root.Cesarzowa)
                        background_color: color_przywodca

                    Button:
                        text: "{} {}".format(root.Krol.power, root.Krol.name)
                        on_release: root.add_card(root.Krol)
                        background_color: color_przywodca

                    Button:
                        text: "{} {}".format(root.Ksiezniczka.power, root.Ksiezniczka.name)
                        on_release: root.add_card(root.Ksiezniczka)
                        background_color: color_przywodca

                    Button:
                        text: "{} {}".format(root.Krolowa.power, root.Krolowa.name)
                        on_release: root.add_card(root.Krolowa)
                        background_color: color_przywodca

                    Button:
                        text: "{} {}".format(root.WielkiWodz.power, root.WielkiWodz.name)
                        on_release: root.add_card(root.WielkiWodz)
                        background_color: color_przywodca

            GridLayout:
                id: grid6
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Broń"
                    on_release: dropdown6.open(self); self.parent.height = '152dp'
                    background_color: color_bron

                Widget:
                    on_parent: dropdown6.dismiss()

                DropDown:
                    id: dropdown6
                    on_dismiss: grid6.height = '26dp'

                    Button:
                        text: "{} {}".format(root.ElfiDlugiLuk.power, root.ElfiDlugiLuk.name)
                        on_release: root.add_card(root.ElfiDlugiLuk)
                        background_color: color_bron

                    Button:
                        text: "{} {}".format(root.MagicznaRozdzka.power, root.MagicznaRozdzka.name)
                        on_release: root.add_card(root.MagicznaRozdzka)
                        background_color: color_bron

                    Button:
                        text: "{} {}".format(root.MieczKetha.power, root.MieczKetha.name)
                        on_release: root.add_card(root.MieczKetha)
                        background_color: color_bron

                    Button:
                        text: "{} {}".format(root.SterowiecWojenny.power, root.SterowiecWojenny.name)
                        on_release: root.add_card(root.SterowiecWojenny)
                        background_color: color_bron

                    Button:
                        text: "{} {}".format(root.Okret.power, root.Okret.name)
                        on_release: root.add_card(root.Okret)
                        background_color: color_bron

            GridLayout:
                id: grid7
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Pogoda"
                    on_release: dropdown7.open(self); self.parent.height = '152dp'
                    background_color: color_pogoda

                Widget:
                    on_parent: dropdown7.dismiss()

                DropDown:
                    id: dropdown7
                    on_dismiss: grid7.height = '26dp'

                    Button:
                        text: "{} {}".format(root.ZywiolakPowietrza.power, root.ZywiolakPowietrza.name)
                        on_release: root.add_card(root.ZywiolakPowietrza)
                        background_color: color_pogoda

                    Button:
                        text: "{} {}".format(root.Sniezyca.power, root.Sniezyca.name)
                        on_release: root.add_card(root.Sniezyca)
                        background_color: color_pogoda

                    Button:
                        text: "{} {}".format(root.Burza.power, root.Burza.name)
                        on_release: root.add_card(root.Burza)
                        background_color: color_pogoda

                    Button:
                        text: "{} {}".format(root.Dym.power, root.Dym.name)
                        on_release: root.add_card(root.Dym)
                        background_color: color_pogoda

                    Button:
                        text: "{} {}".format(root.Tornado.power, root.Tornado.name)
                        on_release: root.add_card(root.Tornado)
                        background_color: color_pogoda

            GridLayout:
                id: grid8
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Artefakt"
                    on_release: dropdown8.open(self); self.parent.height = '152dp'
                    background_color: color_artefakt

                Widget:
                    on_parent: dropdown8.dismiss()

                DropDown:
                    id: dropdown8
                    on_dismiss: grid8.height = '26dp'

                    Button:
                        text: "{} {}".format(root.KsiegaZmian.power, root.KsiegaZmian.name)
                        on_release: root.add_card(root.KsiegaZmian)
                        background_color: color_artefakt

                    Button:
                        text: "{} {}".format(root.TarczaKetha.power, root.TarczaKetha.name)
                        on_release: root.add_card(root.TarczaKetha)
                        background_color: color_artefakt

                    Button:
                        text: "{} {}".format(root.KlejnotPorzadku.power, root.KlejnotPorzadku.name)
                        on_release: root.add_card(root.KlejnotPorzadku)
                        background_color: color_artefakt

                    Button:
                        text: "{} {}".format(root.DrzewoSwiata.power, root.DrzewoSwiata.name)
                        on_release: root.add_card(root.DrzewoSwiata)
                        background_color: color_artefakt

                    Button:
                        text: "{} {}".format(root.RunaOchrony.power, root.RunaOchrony.name)
                        on_release: root.add_card(root.RunaOchrony)
                        background_color: color_artefakt

            GridLayout:
                id: grid9
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Czarodziej"
                    on_release: dropdown9.open(self); self.parent.height = '177dp'
                    background_color: color_czarodziej

                Widget:
                    on_parent: dropdown9.dismiss()

                DropDown:
                    id: dropdown9
                    on_dismiss: grid9.height = '26dp'

                    Button:
                        text: "{} {}".format(root.WladcaBestii.power, root.WladcaBestii.name)
                        on_release: root.add_card(root.WladcaBestii)
                        background_color: color_czarodziej

                    Button:
                        text: "{} {}".format(root.Kolekcjoner.power, root.Kolekcjoner.name)
                        on_release: root.add_card(root.Kolekcjoner)
                        background_color: color_czarodziej

                    Button:
                        text: "{} {}".format(root.Zaklinaczka.power, root.Zaklinaczka.name)
                        on_release: root.add_card(root.Zaklinaczka)
                        background_color: color_czarodziej

                    Button:
                        text: "{} {}".format(root.Nekromanta.power, root.Nekromanta.name)
                        on_release: root.add_card(root.Nekromanta)
                        background_color: color_czarodziej

                    Button:
                        text: "{} {}".format(root.Czarnoksieznik.power, root.Czarnoksieznik.name)
                        on_release: root.add_card(root.Czarnoksieznik)
                        background_color: color_czarodziej

                    Button:
                        text: "{} {}".format(root.Blazen.power, root.Blazen.name)
                        on_release: root.add_card(root.Blazen)
                        background_color: color_czarodziej

            GridLayout:
                id: grid10
                cols: 1
                size_hint_y: None
                height: '26dp'

                Button:
                    text: "Karty specjalne"
                    on_release: dropdown10.open(self); self.parent.height = '102dp'
                    background_color: color_specjalne

                Widget:
                    on_parent: dropdown10.dismiss()

                DropDown:
                    id: dropdown10
                    on_dismiss: grid10.height = '26dp'

                    Button:
                        text: "{} {}".format(root.WladcaBestii.power, root.WladcaBestii.name)
                        on_release: root.add_card(root.WladcaBestii)
                        background_color: color_specjalne

                    Button:
                        text: "{} {}".format(root.Kolekcjoner.power, root.Kolekcjoner.name)
                        on_release: root.add_card(root.Kolekcjoner)
                        background_color: color_specjalne

                    Button:
                        text: "{} {}".format(root.Zaklinaczka.power, root.Zaklinaczka.name)
                        on_release: root.add_card(root.Zaklinaczka)
                        background_color: color_specjalne

        Button:
            text: "POLICZ"
            height: '30dp'
            on_release: root.display_result()
            background_color: [0.2, 0.2, 0.2, 1]
        Button:
            text: "RESET"
            height: '30dp'
            on_release: root.reset()
            background_color: [0.2, 0.2, 0.2, 1]

<WyspaPopup>:
    title: "Wyspa"
    size: (400, 150)
    size_hint: (None, None)

    GridLayout:
        cols: 1
        anchor_y: 'top'
        size: root.width, root.height
        pos: root.x, root.y

        Button:
            text: "18 Bagno"
            on_release: root.use("Bagno")
            background_color: color_powodz

        Button:
            text: "32 Potop"
            on_release: root.use("Potop"); root.dismiss()
            background_color: color_powodz

        Button:
            text: "40 Pożar"
            on_release: root.use("Pożar"); root.dismiss()
            background_color: color_plomien